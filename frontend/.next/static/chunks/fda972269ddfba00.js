(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,a,t)=>{a.exports=e.r(76562)},62590,e=>{"use strict";e.s(["default",()=>o]);var a=e.i(43476),t=e.i(71645),r=e.i(18566),s=e.i(74332),l=e.i(78685),i=e.i(1831),n=e.i(64452);let o=()=>{let e=(0,r.useRouter)(),{showToast:o}=(0,n.useToast)(),[c,d]=(0,t.useState)({certificateType:"",applicantName:"",fatherName:"",motherName:"",date:"",place:"",supportingFiles:[],declaration:!1}),[m,x]=(0,t.useState)({}),[u,p]=(0,t.useState)(!1),[h,f]=(0,t.useState)(null),[g,j]=(0,t.useState)(0),[y,b]=(0,t.useState)(null),[N,v]=(0,t.useState)(!0),[w,k]=(0,t.useState)(null),[C,F]=(0,t.useState)(0),[L,T]=(0,t.useState)("");(0,t.useEffect)(()=>{(async()=>{try{v(!0),k(null);let e=await i.apiClient.getCurrentUser(),a={id:e.id||"",name:e.name||"",email:e.email||"",userType:e.userType||"Citizen"};b(a),d(e=>({...e,applicantName:a.name||""}))}catch(a){console.error("Error fetching user data:",a),k(a instanceof Error?a.message:"Failed to authenticate user. Please login again."),setTimeout(()=>{e.push("/login")},3e3)}finally{v(!1)}})()},[e]);let P=e=>{let{name:a,value:t,type:r}=e.target;if("checkbox"===r){let t=e.target.checked;d(e=>({...e,[a]:t}))}else d(e=>({...e,[a]:t})),m[a]&&x(e=>{let t={...e};return delete t[a],t})},S=async a=>{if(a.preventDefault(),!(()=>{let e={};return c.certificateType||(e.certificateType="Please select a certificate type"),c.applicantName.trim()||(e.applicantName="Applicant name is required"),c.date||(e.date="Date is required"),c.place.trim()||(e.place="Place is required"),c.place&&"string"!=typeof c.place&&(e.place="Place must be a valid text"),c.declaration||(e.declaration="You must declare that the information is correct"),x(e),0===Object.keys(e).length})())return void o("Please fix the errors in the form","error");p(!0),F(0),T("Validating your details...");try{let a=[{progress:20,status:"Validating your details..."},{progress:40,status:"Processing your request..."},{progress:60,status:"Generating certificate..."},{progress:80,status:"Finalizing document..."},{progress:100,status:"Ready for preview!"}];for(let e=0;e<a.length;e++){let{progress:t,status:r}=a[e];F(t),T(r),await new Promise(e=>setTimeout(e,1e3))}let t={applicantName:c.applicantName,fatherName:c.fatherName,motherName:c.motherName,certificateType:c.certificateType,date:c.date,place:c.place,supportingFiles:c.supportingFiles.map(e=>e.name),declaration:c.declaration},r=await i.apiClient.post("/certificates/apply",t);r.success&&r.applicationId?(o("Certificate application submitted successfully!","success"),setTimeout(()=>{e.push("/services/certificates/preview?id=".concat(r.applicationId))},500)):(x({submit:r.message||"Failed to submit application. Please try again."}),F(0),T(""),o(r.message||"Failed to submit application. Please try again.","error"))}catch(a){console.error("Error submitting application:",a);let e=a instanceof Error?a.message:"Failed to submit application. Please try again.";x({submit:e}),F(0),T(""),o(e,"error")}finally{}},A=async e=>{try{if(!(null==h?void 0:h.applicationId))return void o("Application ID not found","error");let a=await i.apiClient.download("/certificates/".concat(h.applicationId,"/download?format=").concat(e)),t=window.URL.createObjectURL(a),r=document.createElement("a");r.href=t,r.download="".concat(c.certificateType.toLowerCase(),"-certificate.").concat(e),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(t),o("Certificate downloaded as ".concat(e.toUpperCase()," successfully!"),"success")}catch(a){console.error("Error downloading ".concat(e.toUpperCase()," certificate:"),a),o(a instanceof Error?a.message:"Failed to download certificate in ".concat(e.toUpperCase()," format. Please try again."),"error")}};return N?(0,a.jsxs)("div",{className:"min-h-screen flex flex-col bg-off-white",children:[(0,a.jsx)(s.default,{}),(0,a.jsx)("main",{className:"flex-grow responsive-container py-8 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading user data..."})]})}),(0,a.jsx)(l.default,{})]}):w?(0,a.jsxs)("div",{className:"min-h-screen flex flex-col bg-off-white",children:[(0,a.jsx)(s.default,{}),(0,a.jsx)("main",{className:"flex-grow responsive-container py-8",children:(0,a.jsx)("div",{className:"max-w-2xl mx-auto bg-white rounded-2xl shadow-lg p-6 sm:p-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Authentication Error"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:w}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Redirecting to login page..."})]})})}),(0,a.jsx)(l.default,{})]}):y?h?(0,a.jsxs)("div",{className:"min-h-screen flex flex-col bg-off-white",children:[(0,a.jsx)(s.default,{}),(0,a.jsx)("main",{className:"flex-grow responsive-container py-8",children:(0,a.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-6 sm:p-8 text-center animate-fade-in",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Application Submitted!"}),(0,a.jsxs)("p",{className:"text-gray-600 mb-6",children:["Your ",c.certificateType," certificate application has been processed successfully."]}),(0,a.jsxs)("div",{className:"bg-emerald-50 rounded-xl p-4 mb-6",children:[(0,a.jsxs)("p",{className:"text-emerald-800 font-medium",children:["Application ID: ",h.applicationId]}),(0,a.jsxs)("p",{className:"text-emerald-700 mt-1",children:["Status: ",(0,a.jsx)("span",{className:"font-semibold",children:h.status})]})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Download Your Certificate"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,a.jsxs)("button",{onClick:()=>A("pdf"),className:"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white px-6 py-3 rounded-xl shadow-soft hover:shadow-md transition-all font-medium flex items-center justify-center transform hover:scale-105 duration-300 focus:outline-none focus:ring-2 focus:ring-emerald-500",children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download PDF"]}),(0,a.jsxs)("button",{onClick:()=>A("jpg"),className:"bg-gradient-to-r from-sky-600 to-sky-700 text-white px-6 py-3 rounded-xl shadow-soft hover:shadow-md transition-all font-medium flex items-center justify-center transform hover:scale-105 duration-300 focus:outline-none focus:ring-2 focus:ring-sky-500",children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download JPG"]})]})]}),(0,a.jsx)("button",{onClick:()=>{f(null),d({certificateType:"",applicantName:y.name||"",fatherName:"",motherName:"",date:"",place:"",supportingFiles:[],declaration:!1})},className:"text-emerald-600 hover:text-emerald-800 font-medium transform hover:scale-105 duration-300 focus:outline-none focus:ring-2 focus:ring-emerald-500 rounded-lg px-3 py-1",children:"Apply for another certificate"})]})})}),(0,a.jsx)(l.default,{})]}):u?(0,a.jsxs)("div",{className:"min-h-screen flex flex-col bg-off-white",children:[(0,a.jsx)(s.default,{}),(0,a.jsx)("main",{className:"flex-grow responsive-container py-8 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-lg p-6 animate-fade-in",children:[(0,a.jsxs)("div",{className:"mb-6 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-emerald-600 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Generating Your Certificate"}),(0,a.jsx)("p",{className:"text-gray-600",children:L})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,a.jsx)("div",{className:"bg-emerald-600 h-2.5 rounded-full transition-all duration-300 ease-in-out",style:{width:"".concat(C,"%")}})}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-500 mt-2",children:[(0,a.jsx)("span",{children:"0%"}),(0,a.jsxs)("span",{children:[C,"%"]}),(0,a.jsx)("span",{children:"100%"})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-1 mt-4",children:[...Array(10)].map((e,t)=>(0,a.jsx)("div",{className:"h-1.5 rounded-full transition-all duration-300 ".concat(C>=(t+1)*10?"bg-emerald-500":"bg-gray-200")},t))}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-4 text-center",children:L})]})}),(0,a.jsx)(l.default,{})]}):(0,a.jsxs)("div",{className:"min-h-screen flex flex-col bg-off-white",children:[(0,a.jsx)(s.default,{}),(0,a.jsx)("main",{className:"flex-grow responsive-container py-8",children:(0,a.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-4 sm:p-6 animate-fade-in form-container",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:"Apply for Certificate"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Fill in the details below to apply for your certificate"})]}),(0,a.jsxs)("form",{onSubmit:S,className:"space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Certificate Type *"}),(0,a.jsxs)("select",{name:"certificateType",value:c.certificateType,onChange:P,className:"w-full px-4 py-2.5 sm:py-3 rounded-xl border text-gray-800 transition-all duration-300 ".concat(m.certificateType?"border-red-500 shake":"border-gray-300 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"),"aria-required":"true",children:[(0,a.jsx)("option",{value:"",className:"text-gray-800",children:"Select Certificate Type"}),(0,a.jsx)("option",{value:"Birth",className:"text-gray-800",children:"Birth Certificate"}),(0,a.jsx)("option",{value:"Death",className:"text-gray-800",children:"Death Certificate"})]}),m.certificateType&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600 animate-shake",role:"alert",children:m.certificateType})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Applicant Name *"}),(0,a.jsx)("input",{type:"text",name:"applicantName",value:c.applicantName,onChange:P,readOnly:!0,className:"w-full px-4 py-2.5 sm:py-3 rounded-xl border border-gray-300 bg-gray-100 cursor-not-allowed text-gray-800",placeholder:"Your name","aria-required":"true"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Auto-filled from your profile"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Father's Name"}),(0,a.jsx)("input",{type:"text",name:"fatherName",value:c.fatherName,onChange:P,className:"w-full px-4 py-2.5 sm:py-3 rounded-xl border border-gray-300 text-gray-800 transition-all duration-300 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Enter father's name"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Mother's Name"}),(0,a.jsx)("input",{type:"text",name:"motherName",value:c.motherName,onChange:P,className:"w-full px-4 py-2.5 sm:py-3 rounded-xl border border-gray-300 text-gray-800 transition-all duration-300 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Enter mother's name"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Date *"}),(0,a.jsx)("input",{type:"date",name:"date",value:c.date,onChange:P,className:"w-full px-4 py-2.5 sm:py-3 rounded-xl border text-gray-800 transition-all duration-300 ".concat(m.date?"border-red-500 shake":"border-gray-300 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"),"aria-required":"true"}),m.date&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600 animate-shake",role:"alert",children:m.date})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Place *"}),(0,a.jsx)("input",{type:"text",name:"place",value:c.place,onChange:P,className:"w-full px-4 py-2.5 sm:py-3 rounded-xl border text-gray-800 transition-all duration-300 ".concat(m.place?"border-red-500 shake":"border-gray-300 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"),placeholder:"Enter place","aria-required":"true"}),m.place&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600 animate-shake",role:"alert",children:m.place})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Supporting Documents"}),(0,a.jsx)("div",{className:"mt-1 flex justify-center px-4 py-6 sm:py-8 border-2 border-gray-300 border-dashed rounded-xl transition-all duration-300 hover:border-emerald-500 hover:bg-emerald-50",children:(0,a.jsxs)("div",{className:"space-y-1 text-center",children:[(0,a.jsx)("svg",{className:"mx-auto h-8 w-8 sm:h-10 sm:w-10 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:(0,a.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row text-sm text-gray-600 mt-2",children:[(0,a.jsxs)("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-emerald-600 hover:text-emerald-500 focus-within:outline-none",children:[(0,a.jsx)("span",{children:"Upload files"}),(0,a.jsx)("input",{type:"file",multiple:!0,accept:".jpg,.jpeg,.png,.pdf",onChange:e=>{if(e.target.files){let a=Array.from(e.target.files);if(a.length>3)return void x(e=>({...e,supportingFiles:"You can upload maximum 3 files"}));let t=["image/jpeg","image/png","application/pdf"];if(a.filter(e=>!t.includes(e.type)).length>0)return void x(e=>({...e,supportingFiles:"Only JPG, PNG, and PDF files are allowed"}));d(e=>({...e,supportingFiles:a})),m.supportingFiles&&x(e=>{let a={...e};return delete a.supportingFiles,a})}},className:"sr-only","aria-label":"Upload supporting documents"})]}),(0,a.jsx)("p",{className:"sm:pl-1 mt-1 sm:mt-0",children:"or drag and drop"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, or PDF up to 3 files"})]})}),m.supportingFiles&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600 animate-shake",role:"alert",children:m.supportingFiles}),c.supportingFiles.length>0&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Selected files:"}),(0,a.jsx)("ul",{className:"list-disc list-inside text-sm text-gray-600 mt-1",children:c.supportingFiles.map((e,t)=>(0,a.jsx)("li",{className:"animate-fade-in truncate",children:e.name},t))})]})]}),(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"flex items-center h-5",children:(0,a.jsx)("input",{id:"declaration",name:"declaration",type:"checkbox",checked:c.declaration,onChange:P,className:"focus:ring-emerald-500 h-4 w-4 text-emerald-600 border-gray-300 rounded transition-all duration-300","aria-required":"true"})}),(0,a.jsxs)("div",{className:"ml-3 text-sm",children:[(0,a.jsx)("label",{htmlFor:"declaration",className:"font-medium text-gray-700",children:"I declare that the information provided is correct and complete *"}),m.declaration&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600 animate-shake",role:"alert",children:m.declaration})]})]}),m.submit&&(0,a.jsx)("div",{className:"rounded-md bg-red-50 p-3 animate-shake",role:"alert",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800",children:m.submit})})]})}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",disabled:u,className:"w-full bg-gradient-to-r from-emerald-600 to-emerald-700 text-white py-2.5 sm:py-3 rounded-xl shadow-soft hover:shadow-md transition-all font-medium flex items-center justify-center disabled:opacity-70 transform hover:scale-105 duration-300 focus:outline-none focus:ring-2 focus:ring-emerald-500","aria-busy":u,children:u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Generate Certificate"})})]})]})})}),(0,a.jsx)(l.default,{})]}):null}}]);