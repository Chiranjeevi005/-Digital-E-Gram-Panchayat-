module.exports=[78726,a=>{"use strict";a.s(["default",()=>i]);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(18637),f=a.i(70794),g=a.i(34075),h=a.i(3318);let i=()=>{let a=(0,d.useRouter)(),{showToast:i}=(0,h.useToast)(),[j,k]=(0,c.useState)({certificateType:"",applicantName:"",fatherName:"",motherName:"",date:"",place:"",supportingFiles:[],declaration:!1}),[l,m]=(0,c.useState)({}),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(0),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(0),[B,C]=(0,c.useState)("");(0,c.useEffect)(()=>{(async()=>{try{w(!0),y(null);let a=await g.apiClient.getCurrentUser(),b={id:a.id||"",name:a.name||"",email:a.email||"",userType:a.userType||"Citizen"};u(b),k(a=>({...a,applicantName:b.name||""}))}catch(b){console.error("Error fetching user data:",b),y(b instanceof Error?b.message:"Failed to authenticate user. Please login again."),setTimeout(()=>{a.push("/login")},3e3)}finally{w(!1)}})()},[a]);let D=a=>{let{name:b,value:c,type:d}=a.target;if("checkbox"===d){let c=a.target.checked;k(a=>({...a,[b]:c}))}else k(a=>({...a,[b]:c})),l[b]&&m(a=>{let c={...a};return delete c[b],c})},E=async b=>{if(b.preventDefault(),!(()=>{let a={};return j.certificateType||(a.certificateType="Please select a certificate type"),j.applicantName.trim()||(a.applicantName="Applicant name is required"),j.date||(a.date="Date is required"),j.place.trim()||(a.place="Place is required"),j.place&&"string"!=typeof j.place&&(a.place="Place must be a valid text"),j.declaration||(a.declaration="You must declare that the information is correct"),m(a),0===Object.keys(a).length})())return void i("Please fix the errors in the form","error");o(!0),A(0),C("Validating your details...");try{let b=[{progress:10,status:"Validating your details..."},{progress:20,status:"Preparing your application..."},{progress:30,status:"Checking document requirements..."},{progress:40,status:"Sending to server..."},{progress:50,status:"Processing your request..."},{progress:60,status:"Verifying information..."},{progress:70,status:"Generating certificate..."},{progress:80,status:"Applying official seal..."},{progress:90,status:"Finalizing document..."},{progress:100,status:"Ready for preview!"}];for(let a=0;a<b.length;a++){let{progress:c,status:d}=b[a];A(c),C(d),await new Promise(a=>setTimeout(a,1e3))}let c={applicantName:j.applicantName,fatherName:j.fatherName,motherName:j.motherName,certificateType:j.certificateType,date:j.date,place:j.place,supportingFiles:j.supportingFiles.map(a=>a.name),declaration:j.declaration},d=await g.apiClient.post("/certificates/apply",c);d.success&&d.applicationId?(i("Certificate application submitted successfully!","success"),setTimeout(()=>{a.push(`/services/certificates/preview?id=${d.applicationId}`)},500)):(m({submit:d.message||"Failed to submit application. Please try again."}),A(0),C(""),i(d.message||"Failed to submit application. Please try again.","error"))}catch(b){console.error("Error submitting application:",b);let a=b instanceof Error?b.message:"Failed to submit application. Please try again.";m({submit:a}),A(0),C(""),i(a,"error")}finally{}},F=async a=>{try{if(!p?.applicationId)return void i("Application ID not found","error");let b=await g.apiClient.download(`/certificates/${p.applicationId}/download?format=${a}`),c=window.URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`${j.certificateType.toLowerCase()}-certificate.${a}`,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(c),i(`Certificate downloaded as ${a.toUpperCase()} successfully!`,"success")}catch(b){console.error(`Error downloading ${a.toUpperCase()} certificate:`,b),i(b instanceof Error?b.message:`Failed to download certificate in ${a.toUpperCase()} format. Please try again.`,"error")}};return v?(0,b.jsxs)("div",{className:"min-h-screen flex flex-col bg-off-white",children:[(0,b.jsx)(e.default,{}),(0,b.jsx)("main",{className:"flex-grow responsive-container py-8 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600 mx-auto"}),(0,b.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading user data..."})]})}),(0,b.jsx)(f.default,{})]}):x?(0,b.jsxs)("div",{className:"min-h-screen flex flex-col bg-off-white",children:[(0,b.jsx)(e.default,{}),(0,b.jsx)("main",{className:"flex-grow responsive-container py-8",children:(0,b.jsx)("div",{className:"max-w-2xl mx-auto bg-white rounded-2xl shadow-lg p-6 sm:p-8",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Authentication Error"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:x}),(0,b.jsx)("p",{className:"text-gray-500 text-sm",children:"Redirecting to login page..."})]})})}),(0,b.jsx)(f.default,{})]}):t?p?(0,b.jsxs)("div",{className:"min-h-screen flex flex-col bg-off-white",children:[(0,b.jsx)(e.default,{}),(0,b.jsx)("main",{className:"flex-grow responsive-container py-8",children:(0,b.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-6 sm:p-8 text-center animate-fade-in",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,b.jsx)("svg",{className:"w-8 h-8 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Application Submitted!"}),(0,b.jsxs)("p",{className:"text-gray-600 mb-6",children:["Your ",j.certificateType," certificate application has been processed successfully."]}),(0,b.jsxs)("div",{className:"bg-emerald-50 rounded-xl p-4 mb-6",children:[(0,b.jsxs)("p",{className:"text-emerald-800 font-medium",children:["Application ID: ",p.applicationId]}),(0,b.jsxs)("p",{className:"text-emerald-700 mt-1",children:["Status: ",(0,b.jsx)("span",{className:"font-semibold",children:p.status})]})]}),(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Download Your Certificate"}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,b.jsxs)("button",{onClick:()=>F("pdf"),className:"bg-gradient-to-r from-emerald-600 to-emerald-700 text-white px-6 py-3 rounded-xl shadow-soft hover:shadow-md transition-all font-medium flex items-center justify-center transform hover:scale-105 duration-300 focus:outline-none focus:ring-2 focus:ring-emerald-500",children:[(0,b.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download PDF"]}),(0,b.jsxs)("button",{onClick:()=>F("jpg"),className:"bg-gradient-to-r from-sky-600 to-sky-700 text-white px-6 py-3 rounded-xl shadow-soft hover:shadow-md transition-all font-medium flex items-center justify-center transform hover:scale-105 duration-300 focus:outline-none focus:ring-2 focus:ring-sky-500",children:[(0,b.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download JPG"]})]})]}),(0,b.jsx)("button",{onClick:()=>{q(null),k({certificateType:"",applicantName:t.name||"",fatherName:"",motherName:"",date:"",place:"",supportingFiles:[],declaration:!1})},className:"text-emerald-600 hover:text-emerald-800 font-medium transform hover:scale-105 duration-300 focus:outline-none focus:ring-2 focus:ring-emerald-500 rounded-lg px-3 py-1",children:"Apply for another certificate"})]})})}),(0,b.jsx)(f.default,{})]}):n?(0,b.jsxs)("div",{className:"min-h-screen flex flex-col bg-off-white",children:[(0,b.jsx)(e.default,{}),(0,b.jsx)("main",{className:"flex-grow responsive-container py-8 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-lg p-6 animate-fade-in",children:[(0,b.jsxs)("div",{className:"mb-6 text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)("svg",{className:"w-8 h-8 text-emerald-600 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Generating Your Certificate"}),(0,b.jsx)("p",{className:"text-gray-600",children:B})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,b.jsx)("div",{className:"bg-emerald-600 h-2.5 rounded-full transition-all duration-300 ease-in-out",style:{width:`${z}%`}})}),(0,b.jsxs)("div",{className:"flex justify-between text-sm text-gray-500 mt-2",children:[(0,b.jsx)("span",{children:"0%"}),(0,b.jsxs)("span",{children:[z,"%"]}),(0,b.jsx)("span",{children:"100%"})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-5 gap-1 mt-4",children:[...Array(10)].map((a,c)=>(0,b.jsx)("div",{className:`h-1.5 rounded-full transition-all duration-300 ${z>=(c+1)*10?"bg-emerald-500":"bg-gray-200"}`},c))}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-4 text-center",children:B})]})}),(0,b.jsx)(f.default,{})]}):(0,b.jsxs)("div",{className:"min-h-screen flex flex-col bg-off-white",children:[(0,b.jsx)(e.default,{}),(0,b.jsx)("main",{className:"flex-grow responsive-container py-8",children:(0,b.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-4 sm:p-6 animate-fade-in form-container",children:[(0,b.jsxs)("div",{className:"text-center mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:"Apply for Certificate"}),(0,b.jsx)("p",{className:"text-gray-600 mt-2",children:"Fill in the details below to apply for your certificate"})]}),(0,b.jsxs)("form",{onSubmit:E,className:"space-y-5",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Certificate Type *"}),(0,b.jsxs)("select",{name:"certificateType",value:j.certificateType,onChange:D,className:`w-full px-4 py-2.5 sm:py-3 rounded-xl border text-gray-800 transition-all duration-300 ${l.certificateType?"border-red-500 shake":"border-gray-300 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"}`,"aria-required":"true",children:[(0,b.jsx)("option",{value:"",className:"text-gray-800",children:"Select Certificate Type"}),(0,b.jsx)("option",{value:"Birth",className:"text-gray-800",children:"Birth Certificate"}),(0,b.jsx)("option",{value:"Death",className:"text-gray-800",children:"Death Certificate"})]}),l.certificateType&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600 animate-shake",role:"alert",children:l.certificateType})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Applicant Name *"}),(0,b.jsx)("input",{type:"text",name:"applicantName",value:j.applicantName,onChange:D,readOnly:!0,className:"w-full px-4 py-2.5 sm:py-3 rounded-xl border border-gray-300 bg-gray-100 cursor-not-allowed text-gray-800",placeholder:"Your name","aria-required":"true"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Auto-filled from your profile"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Father's Name"}),(0,b.jsx)("input",{type:"text",name:"fatherName",value:j.fatherName,onChange:D,className:"w-full px-4 py-2.5 sm:py-3 rounded-xl border border-gray-300 text-gray-800 transition-all duration-300 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Enter father's name"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Mother's Name"}),(0,b.jsx)("input",{type:"text",name:"motherName",value:j.motherName,onChange:D,className:"w-full px-4 py-2.5 sm:py-3 rounded-xl border border-gray-300 text-gray-800 transition-all duration-300 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Enter mother's name"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Date *"}),(0,b.jsx)("input",{type:"date",name:"date",value:j.date,onChange:D,className:`w-full px-4 py-2.5 sm:py-3 rounded-xl border text-gray-800 transition-all duration-300 ${l.date?"border-red-500 shake":"border-gray-300 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"}`,"aria-required":"true"}),l.date&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600 animate-shake",role:"alert",children:l.date})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Place *"}),(0,b.jsx)("input",{type:"text",name:"place",value:j.place,onChange:D,className:`w-full px-4 py-2.5 sm:py-3 rounded-xl border text-gray-800 transition-all duration-300 ${l.place?"border-red-500 shake":"border-gray-300 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"}`,placeholder:"Enter place","aria-required":"true"}),l.place&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600 animate-shake",role:"alert",children:l.place})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-dark-label mb-1",children:"Supporting Documents"}),(0,b.jsx)("div",{className:"mt-1 flex justify-center px-4 py-6 sm:py-8 border-2 border-gray-300 border-dashed rounded-xl transition-all duration-300 hover:border-emerald-500 hover:bg-emerald-50",children:(0,b.jsxs)("div",{className:"space-y-1 text-center",children:[(0,b.jsx)("svg",{className:"mx-auto h-8 w-8 sm:h-10 sm:w-10 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:(0,b.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row text-sm text-gray-600 mt-2",children:[(0,b.jsxs)("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-emerald-600 hover:text-emerald-500 focus-within:outline-none",children:[(0,b.jsx)("span",{children:"Upload files"}),(0,b.jsx)("input",{type:"file",multiple:!0,accept:".jpg,.jpeg,.png,.pdf",onChange:a=>{if(a.target.files){let b=Array.from(a.target.files);if(b.length>3)return void m(a=>({...a,supportingFiles:"You can upload maximum 3 files"}));let c=["image/jpeg","image/png","application/pdf"];if(b.filter(a=>!c.includes(a.type)).length>0)return void m(a=>({...a,supportingFiles:"Only JPG, PNG, and PDF files are allowed"}));k(a=>({...a,supportingFiles:b})),l.supportingFiles&&m(a=>{let b={...a};return delete b.supportingFiles,b})}},className:"sr-only","aria-label":"Upload supporting documents"})]}),(0,b.jsx)("p",{className:"sm:pl-1 mt-1 sm:mt-0",children:"or drag and drop"})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, or PDF up to 3 files"})]})}),l.supportingFiles&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600 animate-shake",role:"alert",children:l.supportingFiles}),j.supportingFiles.length>0&&(0,b.jsxs)("div",{className:"mt-2",children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Selected files:"}),(0,b.jsx)("ul",{className:"list-disc list-inside text-sm text-gray-600 mt-1",children:j.supportingFiles.map((a,c)=>(0,b.jsx)("li",{className:"animate-fade-in truncate",children:a.name},c))})]})]}),(0,b.jsxs)("div",{className:"flex items-start",children:[(0,b.jsx)("div",{className:"flex items-center h-5",children:(0,b.jsx)("input",{id:"declaration",name:"declaration",type:"checkbox",checked:j.declaration,onChange:D,className:"focus:ring-emerald-500 h-4 w-4 text-emerald-600 border-gray-300 rounded transition-all duration-300","aria-required":"true"})}),(0,b.jsxs)("div",{className:"ml-3 text-sm",children:[(0,b.jsx)("label",{htmlFor:"declaration",className:"font-medium text-gray-700",children:"I declare that the information provided is correct and complete *"}),l.declaration&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600 animate-shake",role:"alert",children:l.declaration})]})]}),l.submit&&(0,b.jsx)("div",{className:"rounded-md bg-red-50 p-3 animate-shake",role:"alert",children:(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,b.jsx)("div",{className:"ml-3",children:(0,b.jsx)("h3",{className:"text-sm font-medium text-red-800",children:l.submit})})]})}),(0,b.jsx)("div",{children:(0,b.jsx)("button",{type:"submit",disabled:n,className:"w-full bg-gradient-to-r from-emerald-600 to-emerald-700 text-white py-2.5 sm:py-3 rounded-xl shadow-soft hover:shadow-md transition-all font-medium flex items-center justify-center disabled:opacity-70 transform hover:scale-105 duration-300 focus:outline-none focus:ring-2 focus:ring-emerald-500","aria-busy":n,children:n?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Generate Certificate"})})]})]})})}),(0,b.jsx)(f.default,{})]}):null}}];

//# sourceMappingURL=frontend_src_app_services_certificates_apply_page_tsx_72894aa9._.js.map